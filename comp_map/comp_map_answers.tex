\documentclass[../gatm_answers.tex]{subfiles}

\begin{document}

\section{Composite Mappings of the Plane}

\newcommand{\blanktwomat}{\twomat{\phantom{0}}{\phantom{0}}{}{}}

\begin{outer_problem}[start=1]
\item For Problems~\ref{prob:cm_fill_in_blank_start} through~\ref{prob:cm_fill_in_blank_end}, fill in the blank.
\end{outer_problem}

\begin{inner_problem}[start=1]
\item We start by finding the images of our points under the $-90^\circ$ rotation. \label{prob:cm_fill_in_blank_start}
\end{inner_problem}

\begin{iinner_problem}[start=1]
\item Find the matrix $R$ which results in a $-90^\circ$ rotation.
\end{iinner_problem}

\begin{iinner_problem}
\item  \label{prob:intermediate_result_matrix} Multiply $R$ by our unit vectors and point $(u,v)$: $$\blanktwomat\left[\begin{array}{ccc} 1 & 0 & u \\ 0 & 1 & v \end{array}\right] = \left[\phantom{\begin{array}{ccc} 1 & 0 & u \\ 0 & 1 & v \end{array}}\right].$$
\end{iinner_problem}

\begin{inner_problem}
\item Next, we reflect those intermediate points over the line $y=0$.
\end{inner_problem}

\begin{iinner_problem}[start=1]
\item Find the matrix $S$ which does this.
\end{iinner_problem}

\begin{iinner_problem}
\item Multiply $S$ by the result of Problem~\ref{prob:intermediate_result_matrix}.
\end{iinner_problem}

\begin{inner_problem}
\item You should notice that the net result of the two transformations taken together is a reflection over the line $y=x$. Which matrix represents this transformation?
\end{inner_problem}

\begin{inner_problem}
\item Notice that what we did to achieve this mapping was $$\twomat{1}{0}{0}{-1}\twomat{0}{1}{-1}{0}\left[\begin{array}{ccc} 1 & 0 & u \\ 0 & 1 & v \end{array}\right]=\left[\phantom{\begin{array}{ccc} 1 & 0 & u \\ 0 & 1 & v \end{array}}\right],$$
where we multiplied the two rightmost matrices first but didn't use the associative property to multiply the two leftmost matrices first. See what happens when you multiply the two left hand matrices together: $$\twomat{1}{0}{0}{-1}\twomat{0}{1}{-1}{0}=\blanktwomat.$$ Look familiar?
\end{inner_problem}

\begin{inner_problem}
\item See what happens when you reverse the order of multiplication: \label{prob:cm_fill_in_blank_end}
$$\twomat{1}{0}{0}{-1}\twomat{0}{1}{-1}{0}=\blanktwomat$$
\end{inner_problem}

\begin{inner_problem}
\item
\end{inner_problem}

\begin{iinner_problem}[start=1]
\item What transformation does this new matrix result in?
\end{iinner_problem}

\begin{iinner_problem}
\item How is a reflection followed by a rotation different from a rotation followed by a reflection? Visualize this by following what happens to a point under both sets of transformations.
\end{iinner_problem}

\begin{inner_problem}
\item Notice that we apply the transformations from right to left. If you wanted to read from left to right, what would you have to change about the way you wrote the mapping matrices, the vectors representing points, and the order of the matrices?
\end{inner_problem}

\begin{inner_problem}
\item How does our convention for ordering transformation matrices compare...
\end{inner_problem}

\begin{iinner_problem}[start=1]
\item ... to the convention for writing composite functions, like $f(g(x))$?
\end{iinner_problem}

\begin{iinner_problem}
\item ... to the ``followed by'' convention we used for ``From Snaps to Flips?''
\end{iinner_problem}

\begin{iinner_problem}
\item ... to the ``from \underline{\phantom{0}} to \underline{\phantom{0}}'' convention for transportation matrices?
\end{iinner_problem}

\begin{outer_problem}
\item There are two, infinite classes of matrix which, taken together under multiplication, form a group isomorphic to the isometries of the plane which keep the origin fixed. These are the rotation matrix and reflection matrix. Let's look first at the rotation matrix and make sure that it really always works the way it should.
\end{outer_problem}

\begin{inner_problem}[start=1]
\item What is the result of a rotation by an angle $\theta$ followed by one of $\phi$?
\end{inner_problem}

\begin{inner_problem}
\item Multiply their rotation matrices: $\twomat{\cos \phi}{-\sin \phi}{\sin\phi}{\cos\phi} \twomat{\cos \theta}{-\sin \theta}{\sin\theta}{\cos\theta}=\blanktwomat.$
\end{inner_problem}

\begin{inner_problem}
\item Use the angle addition formulae to simplify your answer.
\end{inner_problem}

\begin{inner_problem}
\item Should the result be the same if you reverse the order of rotation?
\end{inner_problem}

\begin{inner_problem}
\item What happens to the points $(1,0)$, $(0,1)$, and $(x,y)$ when you operate on them with the rotation matrix? $$\twomat{\cos \theta}{-\sin \theta}{\sin\theta}{\cos\theta}\left[\begin{array}{ccc} 1 & 0 & x \\ 0 & 1 & y \end{array}\right].$$
\end{inner_problem}

\begin{outer_problem}
\item Now let's check for the generalized reflection matrix.
\end{outer_problem}

\begin{inner_problem}[start=1]
\item Take the matrix which results in a reflection over the line $y=x\tan \frac{\theta}{2}$ and reflect over that line twice: $$\twomat{\cos\theta}{\sin\theta}{\sin\theta}{-\cos\theta}\twomat{\cos\theta}{\sin\theta}{\sin\theta}{-\cos\theta}.$$
\end{inner_problem}

\begin{inner_problem}
\item Simplify your answer and explain the result.
\end{inner_problem}

\begin{inner_problem}
\item Let's do a reflection over the line $y=\tan\frac{\theta}{2}$ followed by a reflection over the line $y=\tan\frac{\phi}{2}$:
$$\twomat{\cos\theta}{\sin\theta}{\sin\theta}{-\cos\theta}\twomat{\cos\phi}{\sin\phi}{\sin\phi}{-\cos\phi}.$$
\end{inner_problem}

\begin{inner_problem}
\item Simplify your answer using the angle addition formulae, and interpret.
\end{inner_problem}

\begin{inner_problem}
\item Does it make a difference which reflection comes first? Do the matrix multiplication to confirm your answer.
\end{inner_problem}

\begin{outer_problem}
\item We've found specific matrices which map the plane in the following ways:
\begin{itemize}
\item identity;
\item rotation about the origin by $\theta$;
\item reflection over a line $y=x \tan\frac{\theta}{2}$;
\item size change by some factor centered at the origin;
\item stretching along a specific line through the origin by some factor;
\item shearing perpendicular to a specific line through the origin by some factor.
\end{itemize}
We want to generalize those ideas. What does each of the following matrices do? Be quantitative by specifying angle, equation of line, and/or factor:\label{prob:list_transformations}
\end{outer_problem}

\begin{inner_problem}[start=1]
\item $\twomat{1}{0}{0}{1}$ \label{prob:list_transformations_part_start}
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{a}{0}{0}{a}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{\cos\theta}{-\sin\theta}{\sin\theta}{\cos\theta}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{\cos\theta}{\sin\theta}{-\sin\theta}{\cos\theta}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{a}{0}{0}{1}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{1}{0}{0}{a}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{1}{a}{0}{1}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{1}{0}{a}{1}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{a}{b}{ca}{cb}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{-1}{0}{0}{1}$ \label{prob:highlighted_example_list_transformations1}
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{0}{-1}{-1}{0}$ \label{prob:highlighted_example_list_transformations2}
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{\cos 2\theta}{\sin 2\theta}{\sin 2\theta}{-\cos 2\theta}$ \label{prob:list_transformations_part_end}
\end{inner_problem}

\begin{outer_problem}
\item What matrix/transformation undoes each of \ref{prob:list_transformations_part_start} through \ref{prob:list_transformations_part_end}? For instance, matrix~\ref{prob:highlighted_example_list_transformations1} is a rotation of $\theta$. It is undone by a rotation of $-\theta$, which is matrix~\ref{prob:highlighted_example_list_transformations2}.
\end{outer_problem}

\begin{outer_problem}
\item In this problem, you will observe the effects of multiplying two or more matrices. Do the following matrix multiplications, graph the preimage and image, and identify the transformations and their order. Note the effect of order on the outcome!

\begin{minipage}{0.7\textwidth}
But first, an example:
$$\twomat{5}{0}{0}{5}\twomat{.8}{.6}{-.6}{.8}=\twomat{4}{3}{-3}{4}.$$
This is a rotation of $\tan^{-1}\left(-\frac{3}{4}\right)\approx-37^\circ$, followed by a size change by a factor of $5$. Remember to read from right to left. The preimage and image are shown in Figure~\ref{fig:preimage_image_mat}.
\end{minipage}\hfill
\begin{minipage}{0.25\textwidth}
\begin{asy}[width=\textwidth]
draw((-2,0)--(9.5,0),Arrow);
draw((0,-5)--(0,6.5),Arrow);

for (int i = -1; i < 9; ++i) {
	for (int j = -4; j < 6; ++j) {
		dot((i, j), filltype=FillDraw(fillpen=white, drawpen=black));
	}
}
filltype fillc =FillDraw(fillpen=black,drawpen=black);
pen size = 1+currentpen;

dot((0,0), size, fillc);
dot((1,0), size, fillc);
dot((0,1), size, fillc);

dot((3,4), size, fillc);
dot((4,-3), size, fillc);

path rot1=(0,1)..(3,4);
path rot2=(1,0)..(4,-3);

draw(subpath(rot1,0.1,0.9),Arrow);
draw(subpath(rot2,0.1,0.9),Arrow);
\end{asy}
\captionof{figure}{The preimage and image.}
\label{fig:preimage_image_mat}
\end{minipage}
\end{outer_problem}

\begin{inner_problem}[start=1]
\item $\twomat{1}{2}{0}{1}\twomat{.6}{-.8}{.8}{.6}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{.6}{-.8}{.8}{.6}\twomat{1}{2}{0}{1}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{4}{0}{0}{1}\twomat{\frac{\sqrt{3}}{2}}{\frac{1}{2}}{-\frac{1}{2}}{\frac{\sqrt{3}}{2}}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{\frac{\sqrt{3}}{2}}{\frac{1}{2}}{-\frac{1}{2}}{\frac{\sqrt{3}}{2}}\twomat{4}{0}{0}{1}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{.8}{.6}{-.6}{.8}\twomat{5}{0}{0}{5}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{5}{0}{0}{5}\twomat{.8}{.6}{-.6}{.8}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{.6}{-.8}{.8}{.6}\twomat{.8}{-.6}{.6}{.8}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{.6}{.8}{.8}{-.6}\twomat{.6}{.8}{.8}{-.6}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{.6}{.8}{.8}{-.6}\twomat{.8}{.6}{.6}{-.8}$
\end{inner_problem}

\begin{outer_problem}
\item A \textbf{linear mapping} $f$ is one in which all lines are mapped to lines and the origin remains a fixed point. Algebraically, $f\left(\left[\begin{smallmatrix}x \\ y \end{smallmatrix}\right]\right)=xf\left(\left[\begin{smallmatrix}1 \\ 0 \end{smallmatrix}\right]\right)+yf\left(\left[\begin{smallmatrix}0 \\ 1 \end{smallmatrix}\right]\right).$ I claim that we can build any linear mapping of the plane by multiplying together some combination of the matrices from Problem~\ref{prob:list_transformations}. Only two classes of matrix, however, are necessary; all other matrices are products or examples of these. Which two classes of matrix do you think comprise the minimum set from which the others can be composed? Be able to justify your choice.
\end{outer_problem}

\begin{outer_problem}
\item Write matrix products that perform the following mappings. Do the indicated multiplication and graph the results.
\end{outer_problem}

\begin{inner_problem}[start=1]
\item Rotation by $-135^\circ$ followed by a shear by a factor of $\frac{1}{2}$ perpendicular to the $y$-axis \label{prob:matrix_prod_start}
\end{inner_problem}

\begin{inner_problem}
\item Same transformations as in (a), but reversed
\end{inner_problem}

\begin{inner_problem}
\item Stretch in the $y$ direction by a factor of $3$ followed by a rotation of $60^\circ$
\end{inner_problem}

\begin{inner_problem}
\item Same transformations as in (c), but reversed
\end{inner_problem}

\begin{inner_problem}
\item Projection onto the line $y=5x$
\end{inner_problem}

\begin{inner_problem}
\item Reflection over $\theta=\frac{\pi}{12}$ followed by a stretch in the $x$ direction by a factor of $2$
\end{inner_problem}

\begin{inner_problem}
\item Same transformations as in (f), but reversed \label{prob:matrix_prod_end}
\end{inner_problem}

\begin{outer_problem}
\item Write a set of matrices which undoes Problems~\ref{prob:matrix_prod_start} to~\ref{prob:matrix_prod_end}. You will find one of them impossible to undo; explain why.
\end{outer_problem}

\begin{outer_problem}
\item
\end{outer_problem}

\begin{inner_problem}[start=1]
\item Find the height of the parallelogram in Figure~\ref{fig:parallelogram_generic} in terms of $b$ and a trig function in terms of $\varphi$.
\end{inner_problem}

\begin{inner_problem}
\item Find the area of the parallelogram in terms of $a$, $b$, and $\varphi$.
\end{inner_problem}

\begin{figure}[h]
\begin{minipage}{0.33\textwidth}
\begin{asy}[width=\textwidth]
pair A = (0,0);
pair B = (4,4);
pair D = (8,0);
pair C = B+D;
draw(A--B--C--D--cycle);
draw(B--(4,0));

label("$\varphi$", A, 2.8*ENE);
draw(arc((0,0), point(A--D, 0.25), point(A--B,0.25)));
label("$h$", (4,2),W);
label("$b$", A--B, NW);

path a_brace = shift(0,-0.2)*brace(D,A);
draw(a_brace);

draw((4,0.6)--(3.4,0.6)--(3.4,0));

label("$a$", a_brace, S);
\end{asy}
\caption{A parallelogram.}
\label{fig:parallelogram_generic}
\end{minipage}\hfill
\begin{minipage}{0.33\textwidth}
\begin{asy}[width=\textwidth]
pair A = (0,0);
pair B = (4,4);
pair D = (8,0);
pair C = B+D;

path a_brace = rotate(20.0)*shift(0,-0.74)*brace(D,A);
path angle_mark = arc((0,0), point(A--D,0.25), rotate(20.0)*point(A--B, 0.25));
path angle_mark2 = arc((0,0), point(A--D,0.32), rotate(20.0)*point(A--D, 0.25));

A = rotate(20.0)*A;
B = rotate(20.0)*B;
C = rotate(20.0)*C;
D = rotate(20.0)*D;

draw(A--B--C--D--cycle);
draw(B--rotate(20.0)*(4,0));

draw(angle_mark);
draw(angle_mark2);
label("$h$", rotate(20.0)*(4,2),NE);
label("$b$", rotate(20.0)*A--B, NW);

draw(a_brace);
draw(rotate(20.0)*((4,0.6)--(3.4,0.6)--(3.4,0)));

label("$a$", a_brace, rotate(20.0)*S);
label("$\theta$", angle_mark2, ENE);
label("$\phi$", angle_mark, ENE);

draw((-2,0)--(10,0),Arrow);
draw((0,-2)--(0,8),Arrow);

label("$P$", A, SW);
label("$Q$", B, NW);
label("$R$", C, NE);
label("$S$", D, ESE);
\end{asy}
\caption{The parallelogram in the $xy$ plane.}
\label{fig:para_in_xy}
\end{minipage}
\begin{minipage}{0.33\textwidth}
\begin{asy}[width=\textwidth]
import patterns;

add("brick",brick());

draw((0,0)--(7,0),Arrow);
draw((0,0)--(0,6),Arrow);

pair A = (0,0);
pair B = (1,3);
pair C = (6,5);
pair D = (5,2);

draw(A--B--C--D--cycle);
pair K1 = (0,3);
pair K2=(5,3);
pair K3 = (5,0);
pair L0 = (1,2);
pair L1 = (1,5);
pair L3 = (6,2);

draw(A--K1--K2--K3--cycle);
draw(L0--L1--C--L3--cycle);

filldraw(A--K1--B--cycle, pattern("brick"));
filldraw(A--K3--D--cycle, pattern("brick"));
filldraw(L0--B--K2--D--cycle, pattern("brick"));
filldraw(B--L1--C--cycle, pattern("brick"));
filldraw(D--C--L3--cycle, pattern("brick"));

label("$(a,b)$", B, NW);
label("$(c,d)$", D, SE);
label("$(a+c,b+d)$", C, N);

dot(B);
dot(D);
dot(C);

\end{asy}
\caption{Scenario for Problem~\ref{prob:unit_square_into_parallelogram}.}
\label{fig:para_scenario}
\end{minipage}
\end{figure}

\begin{outer_problem}
\item In Figure~\ref{fig:para_in_xy}, we have put our parallelogram onto the $xy$ plane so that $a$ makes an angle of $\theta$ with the $x$ axis and $b$ makes an angle of $\phi$ with the $x$ axis. Thus, $\varphi=\phi-\theta$.
\end{outer_problem}

\begin{inner_problem}[start=1]
\item Rewrite the equation for the area of the parallelogram in terms of $\theta$ and $\phi$.
\end{inner_problem}

\begin{inner_problem}
\item Find the $x$ and $y$ coordinates of $P,Q,R,S$ in terms of $a$, $b$, $\phi$, $\theta$.
\end{inner_problem}

\begin{inner_problem}
\item These coordinates form two column vectors which, taken together as a matrix, map the plane. Write the matrix so that the first column contains the coordinates of $Q$ and the second column contains the coordinates of $S$.
\end{inner_problem}

\begin{inner_problem}
\item Your matrix has two diagonals, $\overline{PR}$ and $\overline{QS}$. One rises from left to right and the other descends from left to right. Subtract the product of the entries of the ascending diagonal from the product of those of the descending diagonal.
\end{inner_problem}

\begin{inner_problem}
\item Use angle addition formulas to simplify your answer.
\end{inner_problem}

\begin{inner_problem}
\item You should find some relationship between your answers to problems 11a and 11d. What is it?
\end{inner_problem}

\begin{inner_problem}
\item The difference of the products of the two diagonals of a $2\times 2$ matrix is called the \textbf{determinant} of the matrix, written $\det \left[\begin{smallmatrix}a & c \\ b & d \end{smallmatrix}\right]=ad-bc$. What does it measure?
\end{inner_problem}

\begin{inner_problem}
\item Find a matrix which produces a rotation. What is its determinant?
\end{inner_problem}

\begin{inner_problem}
\item Find a matrix that produces a reflection.
\end{inner_problem}

\begin{inner_problem}
\item What is the absolute value of its determinant?
\end{inner_problem}

\begin{inner_problem}
\item How does its determinant differ from that of a rotation matrix?
\end{inner_problem}

\begin{inner_problem}
\item What property is not conserved under rotation?
\end{inner_problem}

\begin{inner_problem}
\item What does the size of a determinant indicate?
\end{inner_problem}

\begin{outer_problem}
\item Here is another way to think about the area of the image of the unit square under a linear transformation. First, we use the matrix $\twomat{a}{c}{b}{d}$ to transform the unit square into a parallelogram. Then, we graph the image: \label{prob:unit_square_into_parallelogram}
\end{outer_problem}

\begin{inner_problem}[start=1]
\item There are three rectangles and four triangles in Figure~\ref{fig:para_scenario}. Find the dimensions and the area of each one. You can use this information to figure out the area of the parallelogram in terms of $a$, $b$, $c$, and $d$. Write a sentence or equation explaining how you can use the seven areas to find the area of the parallelogram.
\end{inner_problem}

\begin{inner_problem}
\item Carry out the algebra to find the area.
\end{inner_problem}

\begin{inner_problem}
\item Calculate the determinant of the matrix.
\end{inner_problem}

\begin{inner_problem}
\item What is the relationship between the determinant of the matrix and the area of its associated parallelogram?
\end{inner_problem}

\begin{inner_problem}
\item
\end{inner_problem}

\begin{iinner_problem}[start=1]
\item How would the area you calculated be different if $(a,b)$ and $(c,d)$ had switched places in the graph?
\item What property would no longer be preserved by the transformation?
\item What isometry would have been included in any composition yielding the mapping?
\item What would be true of the determinant?
\end{iinner_problem}

\begin{inner_problem}
\item
\end{inner_problem}

\begin{iinner_problem}[start=1]
\item What does a reversal of the orientation of figure in its image say about the determinant of the transformation matrix?
\end{iinner_problem}

\begin{iinner_problem}
\item What does that same property of the determinant imply that a transformational matrix does?
\end{iinner_problem}

\begin{iinner_problem}
\item What isometry reverses orientation?
\end{iinner_problem}

\begin{inner_problem}
\item
\end{inner_problem}

\begin{iinner_problem}[start=1]
\item What would have happened to the parallelogram if $\left[\begin{smallmatrix}c \\ d \end{smallmatrix}\right]=k\left[\begin{smallmatrix}c \\ d \end{smallmatrix}\right]$?
\end{iinner_problem}

\begin{iinner_problem}
\item What would its area be?
\end{iinner_problem}

\begin{iinner_problem}
\item What would the determinant of the matrix be?
\end{iinner_problem}

\begin{iinner_problem}
\item What if $\left[\begin{smallmatrix}b & d \end{smallmatrix}\right]=r\left[\begin{smallmatrix}a & c \end{smallmatrix}\right]$?
\end{iinner_problem}

\begin{asydef}
void drawFor(real s_x, real s_y, real a, real c, real b, real d, real ap, real cp, real bp, real dp) {
	a *= s_x;
	c *= s_x;
	ap *= s_x;
	cp *= s_x;
	b *= s_y;
	d *= s_y;
	bp *= s_y;
	dp *= s_y;

	real max_x = 1.2*max(a,c,ap,cp,a+c,ap+cp);
	real min_x = 1.2*min(a,c,ap,cp,a+c,ap+cp,0);
	real max_y = 1.2*max(b,d,bp,dp,b+d,bp+dp,1.5);
	real min_y = 1.2*min(b,d,bp,dp,0,b+d,bp+dp);

	draw((min_x,0)--(max_x,0), Arrow);
	draw((0,min_y)--(0,max_y), Arrow);

	draw((0,0)--(a,b)--(a+c,b+d)--(c,d)--cycle, dashed);
	draw((0,0)--(ap,bp)--(ap+cp,bp+dp)--(cp,dp)--cycle);

	if (s_x != 1 || s_y != 1) {
		label("Not to scale", (0,max_y), NE);
	}
}
\end{asydef}

\begin{minipage}{0.5\textwidth}

\begin{minipage}{0.45\textwidth}
i.
\begin{asy}[width=\textwidth]
drawFor(1,1,2,3,4,1,2,3,4,1);
\end{asy}
\end{minipage}\hfill
\begin{minipage}{0.45\textwidth}
iii.
\begin{asy}[width=\textwidth]
drawFor(1,1,2,3,4,1,1,3/2,4,1);
\end{asy}
\end{minipage}

\begin{minipage}{0.45\textwidth}
iv.
\begin{asy}[width=\textwidth]
drawFor(3,1,1,3/2,4,1,1,3/2,0,-5);
\end{asy}
\end{minipage}\hfill
\begin{minipage}{0.45\textwidth}
v.
\begin{asy}[width=\textwidth]
drawFor(3,1,1,3/2,0,-5,1,3/2,0,1);
\end{asy}
\end{minipage}

\begin{minipage}{0.5\textwidth}
vi.
\begin{asy}[width=\textwidth]
drawFor(1,1,1,3/2,0,1,1,0,0,1);
\end{asy}
\end{minipage}
\begin{minipage}{0.45\textwidth}
\label{fig:undo_matrix}
\captionof{figure}{The undoing steps, visualized.}
\end{minipage}

\end{minipage}\hfill
\begin{minipage}{0.5\textwidth}
\begin{enumerate}[label=\roman*.]
\item The determinant is not $0$, so we continue.
\item $a\neq 0$, so we continue.
\item $\twomat{\frac{1}{2}}{0}{0}{1}\twomat{2}{3}{4}{1}=\twomat{1}{\frac{3}{2}}{4}{1}.$
\item $\twomat{1}{0}{-4}{1}\twomat{1}{\frac{3}{2}}{4}{2}=\twomat{1}{\frac{3}{2}}{0}{-5}.$
\item $\twomat{1}{0}{0}{-\frac{1}{5}}\twomat{1}{\frac{3}{2}}{0}{5}=\twomat{1}{\frac{3}{2}}{0}{1}.$
\item $\twomat{1}{-\frac{3}{2}}{0}{1}\twomat{1}{\frac{3}{2}}{0}{1}=\twomat{1}{0}{0}{1}.$
\end{enumerate}
\end{minipage}

\begin{outer_problem}
\item Look at Figure~\ref{fig:undo_matrix} and describe the transformation in each step.
\end{outer_problem}

\begin{outer_problem}
\item
\end{outer_problem}

\begin{inner_problem}[start=1]
\item How do you undo a shear in the $x$ direction?
$\blanktwomat\twomat{1}{s}{0}{1}=\twomat{1}{0}{0}{1}$
\end{inner_problem}

\begin{inner_problem}
\item How do you undo a stretch along the $x$ axis?
$\blanktwomat\twomat{x}{0}{0}{1}=\twomat{1}{0}{0}{1}$
\end{inner_problem}

\begin{inner_problem}
\item How do you undo a shear in the $y$ direction?
$\blanktwomat\twomat{1}{0}{s}{1}=\twomat{1}{0}{0}{1}$
\end{inner_problem}

\begin{inner_problem}
\item How do you undo a stretch along the $y$ axis?
$\blanktwomat\twomat{1}{0}{0}{y}=\twomat{1}{0}{0}{1}$
\end{inner_problem}

\begin{outer_problem}
\item Now let's put this all together. Undo each of the operations in turn, until only matrix $\left[\begin{smallmatrix}a & c \\ b & d \end{smallmatrix}\right]$ remains on the left side. Remember that what you do on the left side of the expression must also be done to the right side, so on the right side you will see the basic operations from which $\left[\begin{smallmatrix}a & c \\ b & d \end{smallmatrix}\right]$ is composed. Order is important!
\end{outer_problem}

\vspace{1.5cm}
$$\mathop{\blanktwomat}^{\tikzmark{a1}}
\mathop{\blanktwomat}^{\tikzmark{b1}}
\mathop{\blanktwomat}^{\tikzmark{c1}}
\mathop{\blanktwomat}^{\tikzmark{d1}}
\mathop{\twomat{1}{-\frac{c}{a}}{0}{1}}^{\tikzmark{d2}}
\mathop{\twomat{1}{0}{0}{\frac{a}{ad-bc}}}^{\tikzmark{c2}}
\mathop{\twomat{1}{0}{-b}{1}}^{\tikzmark{b2}}
\mathop{\twomat{\frac{1}{a}}{0}{0}{1}}^{\tikzmark{a2}}
\twomat{a}{c}{b}{d}$$
$$\Longrightarrow \blanktwomat\blanktwomat\blanktwomat\blanktwomat\twomat{1}{0}{0}{1} = \twomat{a}{c}{b}{d}$$

\tikz[remember picture,auto]{
\path[overlay, ->] (pic cs:a1) edge [bend left] node {undoes} (pic cs:a2);
\path[overlay, ->] (pic cs:b1) edge [bend left] node {undoes} (pic cs:b2);
\path[overlay, ->] (pic cs:c1) edge [bend left] node {undoes} (pic cs:c2);
\path[overlay, ->] (pic cs:d1) edge [bend left] node {undoes} (pic cs:d2);
}

\begin{outer_problem}
\item \label{prob:needed_for_matrix_undo1}Each step in the decomposition of $\twomat{3}{4}{2}{-5}$ is explained below.
\begin{multicols}{2}
\begin{enumerate}[label=(\roman*)]
\item Stretch along the $x$ axis by factor of $\frac{1}{3}$.
$$\twomat{\frac{1}{3}}{0}{0}{1}\twomat{3}{4}{2}{-5}=\twomat{1}{\frac{4}{3}}{2}{-5}$$
\item Shear perpendicular to the $x$ axis by $-2$
$$\twomat{1}{0}{-2}{1}\twomat{1}{\frac{4}{3}}{2}{-5}=\twomat{1}{\frac{4}{3}}{0}{-\frac{23}{3}}$$
\item Stretch along $y$ axis by $-\frac{3}{23}$
$$\twomat{1}{0}{0}{-\frac{3}{23}}\twomat{1}{\frac{4}{3}}{0}{-\frac{23}{3}}=\twomat{1}{\frac{4}{3}}{0}{1}$$
\item Shear perpendicular to the $y$ axis by $-\frac{4}{3}$
$$\twomat{1}{-\frac{4}{3}}{0}{1}\twomat{1}{\frac{4}{3}}{0}{1}=\twomat{1}{0}{0}{1}$$
\end{enumerate}
\end{multicols}
Taken all together, the decomposition is:
$$\twomat{1}{-\frac{4}{3}}{0}{1}\twomat{1}{0}{0}{-\frac{3}{23}}\twomat{1}{0}{-2}{1}\twomat{\frac{1}{3}}{0}{0}{1}\twomat{3}{4}{2}{-5}.$$
Therefore: $$\twomat{3}{4}{2}{-5}=\twomat{3}{0}{0}{1}\twomat{1}{0}{2}{1}\twomat{1}{0}{0}{-\frac{23}{3}}\twomat{1}{\frac{4}{3}}{0}{1}.$$ What does each matrix do?
\end{outer_problem}

\begin{outer_problem}
\setcounter{store_outer_problem}{\value{enumi}}
\item\label{prob:needed_for_matrix_undo2}Here is another way that you could have decomposed the above matrix.
\vspace{-2ex}
$$\mathop{\twomat{1}{0}{0}{\frac{13}{23}}}^{\text{i}}
\mathop{\twomat{1}{-\frac{2}{23}}{0}{1}}^{\text{ii}}
\mathop{\twomat{\frac{1}{\sqrt{13}}}{0}{0}{\frac{1}{\sqrt{13}}}}^{\text{iii}}
\mathop{\twomat{\frac{3}{\sqrt{13}}}{-\frac{2}{\sqrt{13}}}{\frac{2}{\sqrt{13}}}{\frac{3}{\sqrt{13}}}}^{\text{iv}}
\mathop{\twomat{1}{0}{0}{-1}}^{\text{v}}
\twomat{3}{4}{2}{-5}=\twomat{1}{0}{0}{1}.$$
\end{outer_problem}

\begin{inner_problem}[start=1]
\item Identify what matrices i through v each do.
\end{inner_problem}

\begin{outer_problem}
\setcounter{enumi}{\value{store_outer_problem}}
\item (cont.) Next, we undo this sequence of operations by working backwards.
\end{outer_problem}

\vspace{-2ex}
$$\mathop{\twomat{1}{0}{0}{-1}}^{\text{i}}
\mathop{\twomat{\frac{3}{\sqrt{13}}}{\frac{2}{\sqrt{13}}}{-\frac{2}{\sqrt{13}}}{\frac{3}{\sqrt{13}}}}^{\text{ii}}
\mathop{\twomat{\sqrt{13}}{0}{0}{\sqrt{13}}}^{\text{iii}}
\mathop{\twomat{1}{\frac{2}{23}}{0}{1}}^{\text{iv}}
\mathop{\twomat{1}{0}{0}{\frac{23}{13}}}^{\text{v}}
\twomat{1}{0}{0}{1}=\twomat{3}{4}{2}{-5}.$$

\begin{inner_problem}
\item Explain what happens at each matrix, i through v.
\end{inner_problem}

\begin{outer_problem}
\item Find a set of basic transformations which is equivalent to each of the following matrices.\label{prob:basic_transformations}
\end{outer_problem}

\begin{inner_problem}[start=1]
\item $\twomat{12}{8}{5}{15}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{3}{24}{4}{7}$
\end{inner_problem}

\begin{inner_problem}
\item $\twomat{2}{3}{4}{6}$
\end{inner_problem}

\begin{outer_problem}
\item One of the matrices in Problem~\ref{prob:basic_transformations} is a projection onto a line.
\end{outer_problem}

\begin{inner_problem}[start=1]
\item Which matrix is it?
\end{inner_problem}

\begin{inner_problem}
\item What line does it project onto?
\end{inner_problem}

\begin{inner_problem}
\item If you try to decompose this matrix to the identity matrix, what happens? Why?
\end{inner_problem}

\begin{outer_problem}
\item Onto what line does $\left[\begin{smallmatrix} a & b \\ 2a & 2b\end{smallmatrix}\right]$ project the plane? Solve for $a$ and $b$ such that the matrix projects perpendicular onto the line. You can do this because you know that a point on the line should not move under the projection and a point on a line perpendicular to the line has its image on the origin. Using this information you can set up two equations with two unknowns. \label{prob:project_the_plane}
\end{outer_problem}

\begin{outer_problem}
\item Use Problem~\ref{prob:project_the_plane} to decompose $\left[\begin{smallmatrix} 2 & 3 \\ 4 & 6 \end{smallmatrix}\right]$ into a projection to a line followed by a size change.
\end{outer_problem}

\begin{outer_problem}
\item Decompose $\left[\begin{smallmatrix} 1 & 2 \\ 3 & 6\end{smallmatrix}\right]$ into a projection perpendicular to a line followed by a size change.
\end{outer_problem}

\begin{outer_problem}
\item Write matrices which project onto the following lines:
\end{outer_problem}

\begin{inner_problem}[start=1]
\item $y=x$
\end{inner_problem}

\begin{inner_problem}
\item $y=5x$
\end{inner_problem}

\begin{inner_problem}
\item $y=mx$
\end{inner_problem}
\end{document}
